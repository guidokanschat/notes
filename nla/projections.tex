\begin{Definition}{projection}
  A matrix $\matp\in\Cnn$ is called a \define{projection matrix} if
  \begin{gather}
    \matp^2 = \matp.
  \end{gather}

  It is called \define{orthogonal projection matrix}\index{orthogonal}
  if in addition
  \begin{gather}
    \matp^* = \matp.
  \end{gather}

  The associated operators are called (orthogonal) projection or
  (orthogonal) \define{projector}. If a projector is not orthogonal,
  it is also called \define{oblique}.
  \index{projector!orthogonal}
  \index{projector!oblique}
\end{Definition}

\begin{Lemma}{projection-range}
  Let $\matp\in\Cnn$ be an orthogonal projection matrix and
  $V = \range \matp$. Then, for any $\vx\in\C^n$ there holds
  \begin{gather}
    (\id-\matp)\vx \in V^\perp.
  \end{gather}
  
  Furthermore, the orthogonal projection $\matp$ is uniquely
  determined by its range.
\end{Lemma}

\begin{proof}
  Let $\vx,\vy\in \C^n$ arbitrary. Then,
  \begin{gather}
    \scal(\matp\vy,{(\id-\matp)}\vx) = \scal(\vy,\matp{(\id-\matp)}\vx)
    = \scal(\vv,{(\matp-\matp^2)}\vx) = \scal(\vv,{(\matp-\matp)}\vx) = 0.
  \end{gather}
  Since $V=\range \matp$, this implies that $(\id-\matp)\vx \in V^\perp$.

  Let now $\matp_1,\matp_2$ be orthogonal projectors. Then, for any
  $\vx\in\C^n$ there holds
  \begin{align}
    \norm{(\matp_1-\matp_2)\vx}_2^2
    &= \scal({(\matp_1-\matp_2)}\vx,{(\matp_1-\matp_2)}\vx)\\
    &= \scal(\matp_1\vx,{(\matp_1-\matp_2)}\vx) - \scal(\matp_2\vx,{(\matp_1-\matp_2)}\vx)\\
    &= \scal(\matp_1\vx,{(\id-\matp_2)}\vx)
      + \scal(\matp_2\vx,{(\id-\matp_1)}\vx).
  \end{align}
  if now $\range{\matp_1}=\range{\matp_2}$, then both inner products
  vanish. Thus, the operator norm of $\matp_1-\matp_2$ is zero and the
  projectors must be equal.
\end{proof}

\begin{Definition}{projection-distance}
  Let $U,V\subset \C^n$ be two subspaces with orthogonal projectors
  $\matp_U$ and $\matp_V$, respectively. Then, we define their
  \define{distance} as\index{dist}
  \begin{gather}
    \dist(U,V) = \norm{\matp_U-\matp_V}_2.
  \end{gather}
\end{Definition}

\begin{todo}
  \begin{enumerate}
  \item Lemma: the distance is indeed a metric
  \item Remove example below
  \end{enumerate}
\end{todo}

\begin{Lemma}{projection-distance}
  For two subspaces $U,V\subset \C^n$ of unequal dimension there holds
  $\dist(U,V)\ge 1$. The distance of subspaces of equal dimension is
  \begin{align}
    \dist(U,V) &= \max_{\vu\in U}\min_{\vv\in V} \sin\bigl(\angle(u,v)\bigr)\\
               &= \max_{\vv\in V}\min_{\vu\in U} \sin\bigl(\angle(u,v)\bigr).
  \end{align}
\end{Lemma}

\begin{proof}
  Let without loss of generality $\dim U >\dim V$. Then, $U$ contains
  a vector $\vu$ which is orthogonal to $V$. Hence,
  $(\matp_U-\matp_V)\vu=\vu$ and the norm must be greater or equal to
  one.

  Let now $\vu\in U$ with $\norm{\vu}_2=1$. Then
  \begin{gather}
    \norm{(\matp_U-\matp_V)\vu}_2
    = \norm{\vu-\matp_V\vu}_2
    = \norm{\vu-\scal(\vu,\vw)\vw}_2,
  \end{gather}
  for some normalized vector $\vw\in v$. Hence,
  \begin{gather}
    \norm{(\matp_U-\matp_V)\vu}_2^2
    = \norm{\vu}_2^2 - 2 \scal(\vu,\vw)^2 + \scal(\vu,\vw)^2\norm{w}_2^2
    = 1-\cos^2\alpha = \sin^2\alpha,
  \end{gather}
  where $\alpha$ is the angle between $\vu$ and $\vw$. By the
  minimization property of the orthogonal projection, $\alpha$
  minimizes this expression over $V$. For the norm
  $\norm{\matp_U-\matp_V}$, we must take the maximum over $\vu$.
\begin{todo}
  Do this in detail!
\end{todo}
  For the symmetry of the expression, we note that the pair
  $\vu\in U$, $\vw\in V$ already shows that the maximum over $V$
  cannot be smaller than the maximum over $U$. But if it were greater,
  say for a pair $\vv\in V$ and $\vy\in U$, this would imply that the
  maximum over $U$ was not attained at $\vu$.
\end{proof}

\begin{Example}{projection-distance}
  Since the orthogonal projection is uniquely defined by its range, there holds
  \begin{gather}
    \dist(U,U) = \norm{\matp_U-\matp_U}_2 = 0.
  \end{gather}
\end{Example}

% \begin{Example}{projection-distance}
%   Let $U = \spann \vu$ and $V=\spann\vv$ with
%   $\norm{\vu} = \norm{\vv} = 1$. Then,
%   \begin{align}
%     \dist(U,V)^2
%     &= \sup_{\vx\in\C^n}\frac{\norm{\matp_U\vx-\matp_V\vx}^2}{\norm{\vx}^2}\\
%     &= \sup_{\vx\in\C^n}\frac{\norm{\scal(\vx,\vu)\vu - \scal(\vx,\vv)\vv}^2}{\norm{\vx}^2}\\
%     &= \sup_{\vx\in\C^n}\frac{\scal(\vx,\vu)^2+\scal(\vx,\vv)^2 - 2\scal(\vx,\vu)\scal(\vx,\vv)\scal(\vu,\vv)}{\norm{\vx}^2}\\
%   \end{align}
% \end{Example}


\begin{Lemma}{projection-complement}
  If $\matp\in\Cnn$ is a projection operator, so is
  $\id-\matp$, and there holds
  \begin{gather}
    \ker{\matp} = \range{\id-\matp}.
  \end{gather}
  Furthermore, there holds
  \begin{gather}
    \C^n = \ker{\matp} \oplus \range{\matp}.
  \end{gather}
\end{Lemma}

\begin{proof}
  \cite[Section 1.12.1]{Saad00}.
\end{proof}

\begin{Lemma}{projection-spaces}
  Any pair of subspaces $N,R\subset \C^n$ such that $\C^n = N\oplus R$
  uniquely defines a projector $\matp$, such that $N = \ker\matp$ and
  $R=\range\matp$. There holds for $\vx\in\C^n$
  \begin{align}
    \matp \vx &\in R\\
    \vx - \matp \vx &\in N.
  \end{align}
  We say $\matp$ projects onto $R$ along $N$.
\end{Lemma}

\begin{proof}
  \cite[Section 1.12.1]{Saad00}.
\end{proof}

\begin{Definition}{projection-spaces-orthogonal}
  Given two subspaces $R,S\subset\C^n$ of equal dimension, a
  projector $\matp$ is said to project onto $R$ orthogonal to $S$, if
  for any $\vx\in\C^n$ there holds
  \begin{align}
    \matp\vx &\in R\\
    \vx-\matp\vx &\perp S.
  \end{align}
\end{Definition}

\begin{Lemma}{projection-spaces-orthogonal}
  Let $R,S\subset\C^n$ be two subspaces of equal dimension. Then, the
  projection of any vector $\vx\in\C^n$ onto $R$ orthogonal to $S$ is
  uniquely defined if and only if no vector in $R$ is orthogonal to
  $S$.
\end{Lemma}

\begin{proof}
  \cite[Lemma 1.36]{Saad00}.
\end{proof}

\begin{Definition}{biorthogonal}
  Two sets of vectors $\{\vv_1,\dots,\vv_m\}$ and  $\{\vw_1,\dots,\vw_m\}$ are called \define{biorthogonal}, if
  \begin{gather}
    \scal(\vv_i,\vw_j) = \delta_{ij}, \qquad i,j=1,\dots,m.
  \end{gather}
  In matrix notation
  \begin{gather}
    \matw^*\matv = \matv^*\matw = \id
  \end{gather}
\end{Definition}

\begin{Lemma}{projection-basis}
  Let $R,S\subset\C^n$ be two subspaces of equal dimension and let
  $\matp$ be the projector onto $R$ orthogonal to $S$. Let
  $\{\vv_1,\dots,\vv_m\}$ and $\{\vw_1,\dots,\vw_m\}$ be biorthogonal
  and bases of $R$ and $S$, respectively. Then,
  \begin{gather}
    \matp = \matv\matw^*.
  \end{gather}
\end{Lemma}

\begin{proof}
  \cite[Section 1.12.2]{Saad00}.
\end{proof}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
